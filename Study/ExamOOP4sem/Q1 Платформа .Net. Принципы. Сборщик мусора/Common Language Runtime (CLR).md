# **Common Language Runtime (CLR)** 
— компонент архитектуры .NET, который обеспечивает **управляемую среду выполнения для приложений**.

При компиляции программы C# результирующий исполняемый код находится на **промежуточном языке**, называемом **Common Intermediate Language (CIL)**. Этот код не зависит от машины и может работать на любой платформе, на которой установлена ​​CLR. Когда выполняется код CIL, CLR компилирует его в машинный код, который может быть выполнен процессором.

### *Работа CLR*

*1. Составление и исполнение:

- Когда мы пишем программу на C#, она компилируется в код промежуточного языка (IL), который не зависит от платформы.
- Затем CLR использует компилятор [[JIT-компилятор|Just-In-Time (JIT)]] для преобразования кода IL в машинно-специфичный код во время выполнения программы.

*2. Услуги, предоставляемые CLR:*

- CLR осуществляет автоматическое управление памятью посредством [[Сборщик мусора|сборки мусора]], предотвращая утечки памяти.
- Он обеспечивает правильное и безопасное использование типов данных.
- Перед запуском CLR проверяет код IL на наличие угроз безопасности.

*3. Межъязыковая интеграция:*

CLR позволяет коду из разных языков [[Платформа .Net.|.NET]] (C#, VB.NET, F#) беспрепятственно работать вместе с помощью Common Type System (CTS).

### *Ключевые компоненты CLR*

CLR предоставляет общую среду выполнения или исполнения, поскольку существует более 60 языков программирования [[Платформа .Net.|.NET]]. 

- <b><font color="#ffc000">Спецификация общего языка (CLS, Common Language Specification)</font></b>: определяет общие правила, позволяющие взаимодействовать коду, написанному на разных языках.
    - ***Управляемый код***: Код, который управляется CLR. ~~Для управляемого кода CLR предоставляет три средства [[Платформа .Net.|.NET]]:~~ 
    - ***Неуправляемый код***: Код, который не управляется CLR, а управляется операционной системой.

- **[[JIT-компилятор]]** : преобразует IL-код в машинный код, специфичный для системы, во время выполнения, оптимизируя выполнение.
- **[[Сборщик мусора]]**: автоматически управляет памятью, освобождая неиспользуемые объекты, что снижает необходимость ручного управления памятью.
- <b> <font color="#ffc000">Система общих типов (Common Type System, CTS):</font></b> Это гарантирует, что различные типы данных в разных языках понимаются CLR и могут работать вместе. Существует 2 типа CTS, которые есть в каждом языке программирования [[Платформа .Net.|.NET]]:
    - ***Типы значений:*** типы значений сохранят значение непосредственно в стеке. ~~CLR разрешает использовать память для них во время компиляции.~~
    - ***Ссылочные типы*** : Ссылочные типы будут содержать адрес памяти значения, поскольку ссылочные типы не будут хранить значение переменной непосредственно в стеке. Эти типы работают с механизмом кучи. ~~CLR выделяет для них память во время выполнения.~~